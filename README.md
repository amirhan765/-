Введение: 
Современные фитнес-сервисы и приложения предлагают большое количество тренировочных программ, однако пользователю трудно подобрать план самостоятельно: нужно учитывать цель (похудение, набор мышечной массы, выносливость, гибкость), уровень подготовки, доступное оборудование, длительность тренировки и опыт. Ошибки в подборе нагрузки приводят либо к отсутствию прогресса, либо к перегрузке и риску травм.
Цель проекта — разработать и реализовать на Python (TensorFlow/Keras) модель нейронной сети для генерации персонального плана тренировки на основе параметров пользователя, с возможностью интерактивной демонстрации результата в Google Colab и HTML-приложении.
Основные задачи:
- Сформировать датасет тренировочных примеров на основе пользовательских параметров и правил разметки плана (3 упражнения).
- Подготовить данные: нормализовать числовые признаки и закодировать категориальные признаки.
- Построить полносвязную нейронную сеть (MLP) с несколькими выходами для предсказания трёх упражнений.
- Выполнить обучение модели и оценить качество по метрикам (accuracy и loss), построить графики обучения/валидации.
- Реализовать генерацию плана по параметрам пользователя и вывести результат в интерактивном HTML.
Глава 1. Анализ аналогов и связанных решений

В рамках обзора существующих подходов к составлению тренировочных планов были рассмотрены следующие типы решений:

Шаблонные планы тренировок (универсальные программы)
Планы вида “похудение за 4 недели”, “база для новичка”, “силовая на массу” часто не учитывают индивидуальные параметры: уровень подготовки, доступное оборудование, длительность тренировки, ограничения по здоровью.
Преимущество: простота и быстрый старт. Недостаток: низкая персонализация и риск несоответствия нагрузок.

Экспертные системы и rule-based генераторы
Планы строятся по логическим правилам: “если цель X и уровень Y, то упражнения A/B/C”.
Преимущество: прозрачность — легко объяснить, почему выбран план. Недостаток: при росте числа условий и упражнений правила становятся громоздкими, сложно поддерживать качество и масштабировать систему.

Рекомендательные системы (по похожим пользователям/истории)
Рекомендации строятся на основе поведения пользователей: истории тренировок, лайков/оценок, результатов прогресса.
Преимущество: персонализация повышается с накоплением данных. Недостаток: необходимы реальные логи и большая база пользователей; на старте качество ограничено.
Машинное обучение на табличных признаках
Используются модели классификации/ранжирования (например, деревья решений, случайный лес, градиентный бустинг), где вход — параметры пользователя, а выход — рекомендуемые упражнения.
Преимущество: работает с большим числом признаков и нелинейностями. Недостаток: часто требуется ручная инженерия признаков и сложнее получить “структурированный план”, а не одну рекомендацию.
Глубокое обучение и нейронные сети
Полносвязные сети (MLP) и другие архитектуры могут моделировать сложные зависимости между признаками пользователя и результатом. Также возможно делать multi-output/multi-task постановку, когда модель предсказывает несколько элементов плана сразу.
Преимущество: гибкая персонализация и единая архитектура для разных комбинаций входных параметров. Недостаток: качество сильно зависит от данных и правильной настройки обучения.
Вывод: в проекте выбран подход с использованием нейронной сети на TensorFlow/Keras (полносвязная MLP) с предсказанием трёх упражнений, так как он позволяет автоматически формировать структурированный план и легко расширяется при увеличении числа упражнений и признаков.

Глава 2. Подробное пояснение слайдов 3–8
Ниже приводится текстовое пояснение логики проекта, соответствующее содержанию презентации (слайды 3–8).
2.1. Структура данных и подготовка датасета (слайд 3) 
Глава 2. Методы и этапы исследования
Исходные данные формируются программно и содержат параметры пользователя и тренировки:
age (возраст)
goal (цель)
level (уровень подготовки)
workout_type (тип тренировки)
equipment (доступное оборудование)
duration_minutes (длительность)
experience_months (опыт в месяцах)
Для каждой записи формируется целевая разметка плана тренировки — три упражнения ex1, ex2, ex3. Разметка создаётся алгоритмом правил (функция pick_exercises), который учитывает цель, тип тренировки, оборудование, длительность и опыт. Затем упражнения переводятся в индексы классов (y1, y2, y3) по общему списку all_exercises.
2.2. Предобработка и разбиение данных (слайд 4)
Числовые признаки (age, duration_minutes, experience_months) нормализуются методом z-score:
(x − mean) / std, что ускоряет и стабилизирует обучение.
Категориальные признаки (goal, level, workout_type, equipment) переводятся в числовой вид с помощью One-Hot кодирования (pd.get_dummies).
Разделение на выборки:
данные делятся на обучающую и тестовую выборки в пропорции 80/20 (train_test_split(test_size=0.2)).
2.3. Архитектура модели (слайды 5–6)
Модель реализована на TensorFlow/Keras и является полносвязной сетью (MLP):
Вход: вектор признаков пользователя (нормализованные числовые + one-hot категориальные)
Скрытые слои: 128 → 64 → 32 нейрона с активацией ReLU
После каждого скрытого слоя используется BatchNormalization и Dropout(0.40) для снижения переобучения
Дополнительный скрытый слой: Dense(64, ReLU)
Выходная часть состоит из трёх параллельных выходов
ex1: Softmax по классам упражнений
ex2: Softmax по классам упражнений
ex3: Softmax по классам упражнений
Такая multi-output постановка позволяет предсказывать сразу три элемента плана тренировки.
2.4. Гиперпараметры и обучение (слайд 7)
Основные параметры обучения:
optimizer: Adam
learning_rate: 0.001
epochs: 45
batch_size: 256
loss: sparse_categorical_crossentropy (для каждого выхода)
Для контроля качества и устойчивости обучения используются callbacks:
EarlyStopping по val_loss (с восстановлением лучших весов)
ReduceLROnPlateau (уменьшение learning rate при ухудшении прогресса)
2.5. Графики и визуальный анализ (слайд 8)
В проекте реализована визуализация процесса обучения:
графики accuracy и loss на обучении и валидации по эпохам
сглаживание кривых (rolling mean) для более наглядного отображения динамики
Также реализована демонстрация результата:
функция генерации плана по входным параметрам пользователя в Colab
интерактивное HTML-приложение (workout_generator.html) для визуального показа плана и параметров
Алгоритмы, использованные в проекте (минимум 5)
В проекте реализованы следующие алгоритмы/подходы:
алгоритм генерации и разметки датасета по правилам (pick_exercises)
нормализация числовых признаков (z-score)
One-Hot кодирование категориальных признаков
разбиение на train/test 80/20
обучение нейросети (backpropagation + Adam)
регуляризация Dropout
BatchNormalization для стабилизации обучения
EarlyStopping по val_loss
ReduceLROnPlateau (адаптация learning rate)
постобработка предсказаний: устранение повторов упражнений через выбор следующего по вероятности
Перспективы развития
Подключение реальных данных (история тренировок, прогресс, обратная связь пользователей).
Расширение выходов модели: прогноз подходов/повторений и времени отдыха как отдельных параметров.
Учет ограничений: травмы, противопоказания, приоритеты упражнений.
Улучшение архитектуры: attention-механизм для согласованности упражнений в плане и более логичной структуры.
Разработка API-сервиса (FastAPI) и полноценного веб-интерфейса вместо статичного HTML.
авторы проэкта Мангушев Амир Русланович Ахтямов Николай Сергеевич 15.27Д-ПИ05/25б
